<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>IMOK PERSONAL GEAR ‚Äî Ê©üÊùêË¶ãÁ©ç„Çä</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Noto+Sans+JP:wght@300;400;500;700&family=IBM+Plex+Mono:wght@400;500&display=swap');
  :root {
    --bg: #0a0a0a; --surface: #141414; --surface2: #1c1c1c;
    --border: #2a2a2a; --accent: #e8d44d; --accent2: #ff6b35;
    --text: #f0f0f0; --muted: #666; --checked-bg: #1c1a00; --checked-border: #4a4200;
  }
  * { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
  body { background:var(--bg); color:var(--text); font-family:'Noto Sans JP',sans-serif; font-weight:300; font-size:15px; }
  .header { border-bottom:1px solid var(--border); padding:16px 20px; display:flex; align-items:center; gap:14px; position:sticky; top:0; background:var(--bg); z-index:100; }
  .header-logo { font-family:'Bebas Neue',sans-serif; font-size:26px; letter-spacing:4px; color:var(--accent); }
  .header-sub { font-size:10px; letter-spacing:2px; color:var(--muted); }
  .main { padding:20px 16px 200px; }
  .section-hd { font-family:'IBM Plex Mono',monospace; font-size:10px; letter-spacing:3px; color:var(--muted); text-transform:uppercase; margin-bottom:16px; padding-bottom:10px; border-bottom:1px solid var(--border); }
  .select-bar { display:flex; gap:8px; margin-bottom:20px; }
  .btn-sm { font-family:'IBM Plex Mono',monospace; font-size:11px; letter-spacing:1px; padding:10px 18px; border:1px solid var(--border); background:var(--surface); color:var(--muted); cursor:pointer; border-radius:8px; text-transform:uppercase; }
  .btn-sm:active { background:var(--surface2); color:var(--accent); }
  .category { margin-bottom:28px; }
  .category-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:8px; }
  .category-name { font-family:'IBM Plex Mono',monospace; font-size:10px; letter-spacing:3px; color:var(--accent2); text-transform:uppercase; padding-left:4px; }
  .cat-btns { display:flex; gap:6px; }
  .btn-cat { font-family:'IBM Plex Mono',monospace; font-size:10px; padding:5px 10px; border:1px solid var(--border); background:transparent; color:var(--muted); cursor:pointer; border-radius:6px; letter-spacing:1px; text-transform:uppercase; }
  .btn-cat:active { color:var(--accent); border-color:var(--accent); }
  .gear-item { display:flex; align-items:center; gap:14px; padding:13px 14px; border-radius:10px; border:1.5px solid transparent; margin-bottom:5px; cursor:pointer; user-select:none; background:var(--surface); }
  .gear-item:active { opacity:0.75; }
  .gear-item.selected { background:var(--checked-bg); border-color:var(--checked-border); }
  .gear-item input[type="checkbox"] { display:none; }
  .chk { width:28px; height:28px; border-radius:7px; border:2px solid #3a3a3a; background:var(--surface2); flex-shrink:0; display:flex; align-items:center; justify-content:center; font-size:18px; line-height:1; color:transparent; transition:all 0.15s; }
  .gear-item.selected .chk { background:var(--accent); border-color:var(--accent); color:#111; }
  .gear-name { font-size:14px; line-height:1.45; flex:1; }
  .gear-item.selected .gear-name { color:var(--accent); font-weight:500; }

  /* BOTTOM BAR */
  .bottom-bar { position:fixed; bottom:0; left:0; right:0; background:var(--surface); border-top:1px solid var(--border); z-index:200; }
  .bottom-bar-handle { padding:14px 20px; display:flex; align-items:center; justify-content:space-between; cursor:pointer; }
  .bar-left { display:flex; align-items:baseline; gap:10px; }
  .bar-count { font-family:'Bebas Neue',sans-serif; font-size:34px; color:var(--accent); line-height:1; }
  .bar-count-label { font-size:12px; color:var(--muted); letter-spacing:1px; }
  .bar-right { display:flex; align-items:center; gap:14px; }
  .bar-price { font-family:'Bebas Neue',sans-serif; font-size:22px; color:var(--text); letter-spacing:1px; }
  .bar-toggle { width:36px; height:36px; border-radius:50%; background:var(--surface2); border:1px solid var(--border); display:flex; align-items:center; justify-content:center; font-size:16px; transition:transform 0.3s; }
  .bottom-bar.expanded .bar-toggle { transform:rotate(180deg); }
  .sheet-body { max-height:0; overflow:hidden; transition:max-height 0.35s cubic-bezier(0.4,0,0.2,1); }
  .bottom-bar.expanded .sheet-body { max-height:80vh; overflow-y:auto; }
  .sheet-inner { padding:0 20px 32px; display:flex; flex-direction:column; gap:16px; }

  .price-block, .client-block { background:var(--surface2); border:1px solid var(--border); border-radius:10px; padding:16px; }
  .block-label { font-family:'IBM Plex Mono',monospace; font-size:10px; letter-spacing:3px; color:var(--muted); text-transform:uppercase; margin-bottom:10px; }
  .price-presets { display:flex; gap:8px; flex-wrap:wrap; margin-bottom:12px; }
  .preset-btn { font-family:'IBM Plex Mono',monospace; font-size:12px; padding:8px 14px; border:1.5px solid var(--border); background:var(--surface); color:var(--text); cursor:pointer; border-radius:6px; }
  .preset-btn.active { background:var(--accent); color:#000; border-color:var(--accent); font-weight:500; }
  .price-input-wrap { display:flex; align-items:center; gap:8px; background:var(--bg); border:1.5px solid var(--border); border-radius:8px; padding:10px 16px; }
  .price-input-wrap:focus-within { border-color:var(--accent); }
  .price-currency { font-family:'Bebas Neue',sans-serif; font-size:22px; color:var(--muted); }
  .price-input { background:transparent; border:none; outline:none; color:var(--accent); font-family:'Bebas Neue',sans-serif; font-size:30px; width:100%; }
  .field-group { margin-bottom:12px; }
  .field-label { font-family:'IBM Plex Mono',monospace; font-size:10px; letter-spacing:2px; color:var(--muted); text-transform:uppercase; margin-bottom:6px; }
  .field-input { width:100%; background:var(--bg); border:1.5px solid var(--border); border-radius:8px; padding:12px 14px; color:var(--text); font-family:'Noto Sans JP',sans-serif; font-size:15px; outline:none; }
  .field-input:focus { border-color:var(--accent); }
  .btn-generate { width:100%; background:var(--accent); color:#000; border:none; padding:18px; font-family:'Bebas Neue',sans-serif; font-size:20px; letter-spacing:4px; cursor:pointer; border-radius:10px; }
  .btn-generate:active { opacity:0.85; }
  .btn-generate:disabled { background:var(--border); color:var(--muted); }

  /* MODAL */
  .modal-overlay { position:fixed; inset:0; background:#fff; z-index:300; display:none; flex-direction:column; overflow-y:auto; }
  .modal-overlay.open { display:flex; }
  .modal { background:#fff; color:#111; width:100%; min-height:100%; font-family:'Noto Sans JP',sans-serif; }
  .doc { padding:28px 20px; }
  .doc-header { margin-bottom:24px; padding-bottom:18px; border-bottom:2px solid #111; }
  .doc-title { font-family:'Bebas Neue',sans-serif; font-size:38px; letter-spacing:6px; color:#111; line-height:1; }
  .doc-title-sub { font-size:11px; color:#999; letter-spacing:1px; margin-top:4px; }
  .doc-meta-row { display:flex; justify-content:space-between; margin-top:14px; font-size:12px; color:#666; flex-wrap:wrap; gap:4px; }
  .doc-meta-row strong { color:#111; font-weight:500; }
  .doc-section-label { font-size:10px; letter-spacing:2px; text-transform:uppercase; color:#999; margin-bottom:4px; }
  .doc-section-value { font-size:18px; font-weight:700; color:#111; }
  .doc-table { width:100%; border-collapse:collapse; margin-bottom:24px; font-size:13px; }
  .doc-table th { background:#111; color:#fff; font-size:10px; letter-spacing:2px; text-transform:uppercase; padding:9px 12px; text-align:left; font-weight:400; }
  .doc-table td { padding:9px 12px; border-bottom:1px solid #eee; }
  .doc-table tr:nth-child(even) td { background:#fafafa; }
  .doc-total-box { background:#111; color:#fff; padding:18px 20px; border-radius:8px; margin-bottom:20px; }
  .total-row { display:flex; justify-content:space-between; align-items:baseline; margin-bottom:6px; font-size:13px; color:#888; }
  .total-row.main { border-top:1px solid #333; padding-top:12px; margin-top:12px; font-size:15px; color:#e8d44d; }
  .total-val { font-family:'Bebas Neue',sans-serif; font-size:20px; letter-spacing:1px; color:#bbb; }
  .total-val.main { font-size:30px; color:#e8d44d; }
  .doc-note { background:#f8f8f8; border-left:3px solid #e8d44d; padding:12px 16px; font-size:12px; color:#555; border-radius:0 6px 6px 0; line-height:1.7; margin-bottom:20px; }
  .doc-footer { border-top:1px solid #ddd; padding-top:14px; font-size:11px; color:#aaa; text-align:center; line-height:1.8; }
  .modal-actions { position:sticky; bottom:0; background:#fff; border-top:1px solid #ddd; padding:14px 20px; display:flex; gap:12px; }
  .btn-print { flex:1; background:#111; color:#fff; border:none; padding:14px; font-family:'Noto Sans JP',sans-serif; font-size:14px; cursor:pointer; border-radius:8px; }
  .btn-close2 { background:transparent; color:#111; border:1px solid #ddd; padding:14px 20px; font-family:'Noto Sans JP',sans-serif; font-size:14px; cursor:pointer; border-radius:8px; }
  .doc-total-simple { border:1px solid #ddd; border-radius:8px; padding:20px 24px; margin-bottom:20px; }
  .total-simple-row { display:flex; justify-content:space-between; padding:8px 0; border-bottom:1px solid #f0f0f0; font-size:14px; color:#444; }
  .total-simple-row:last-of-type { border-bottom:none; }
  .total-simple-main { padding-top:14px; margin-top:6px; border-top:2px solid #111 !important; border-bottom:none !important; font-size:18px; font-weight:700; color:#111; }
  .total-simple-main span:last-child { font-size:22px; }

  /* ===== 2-PAGE DOC STYLES ===== */
  .page {
    background: #fff;
    font-family: 'Noto Sans JP', sans-serif;
    color: #111;
    padding: 48px 52px;
    max-width: 800px;
    margin: 0 auto;
  }
  .page2 { }

  /* Header */
  .p1-header { display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:16px; }
  .p1-logo { font-family:'Bebas Neue',sans-serif; font-size:32px; letter-spacing:4px; color:#111; line-height:1; }
  .p1-logo-sub { font-size:12px; color:#888; margin-top:4px; letter-spacing:1px; }
  .p1-right { text-align:right; }
  .p1-title { font-family:'Noto Sans JP',sans-serif; font-size:26px; font-weight:700; letter-spacing:6px; color:#111; line-height:1; }
  .p1-meta { font-size:13px; color:#888; margin-top:6px; letter-spacing:1px; font-family:'IBM Plex Mono',monospace; }

  .p1-rule { border:none; border-top:2px solid #111; margin:0 0 28px 0; }

  /* Info grid */
  .p1-info-grid { display:grid; grid-template-columns:1fr 1fr; gap:24px 48px; margin-bottom:32px; }
  .p1-info-label { font-size:11px; color:#aaa; letter-spacing:1px; margin-bottom:6px; }
  .p1-info-value { font-size:16px; color:#111; border-bottom:1.5px solid #111; padding-bottom:6px; min-height:28px; }
  .p1-info-value.bold { font-weight:700; font-size:18px; }
  .p1-info-sub { font-size:11px; color:#666; margin-top:4px; line-height:1.7; }

  /* Main table */
  .p1-table { width:100%; border-collapse:collapse; margin-bottom:32px; }
  .p1-table thead tr { background:#111; color:#fff; }
  .p1-th-item { padding:11px 16px; font-size:13px; font-weight:700; text-align:left; width:25%; }
  .p1-th-detail { padding:11px 16px; font-size:13px; font-weight:700; text-align:left; }
  .p1-th-price { padding:11px 16px; font-size:13px; font-weight:700; text-align:right; width:15%; }
  .p1-td-item { padding:18px 16px; font-size:15px; font-weight:700; border-bottom:1px solid #e8e8e8; vertical-align:top; }
  .p1-td-detail { padding:18px 16px; font-size:13px; color:#555; border-bottom:1px solid #e8e8e8; vertical-align:top; line-height:1.8; }
  .p1-td-price { padding:18px 16px; font-size:15px; font-weight:500; text-align:right; border-bottom:1px solid #e8e8e8; vertical-align:top; letter-spacing:1px; }

  /* Total box */
  .p1-total-wrap { display:flex; justify-content:flex-end; }
  .p1-total-box { border:1.5px solid #111; border-radius:4px; padding:20px 28px; width:300px; }
  .p1-total-row { display:flex; justify-content:space-between; font-size:13px; color:#555; margin-bottom:10px; }
  .p1-total-rule { border:none; border-top:1px solid #ccc; margin:12px 0; }
  .p1-total-main { font-size:17px; font-weight:700; color:#111; margin-bottom:0; }
  .p1-total-main span:last-child { font-size:20px; }

  /* Page 2 table */
  .p2-table { width:100%; border-collapse:collapse; }
  .p2-th-num { background:#111; color:#fff; padding:9px 12px; font-size:11px; font-weight:400; letter-spacing:2px; width:40px; text-align:center; }
  .p2-th-item { background:#111; color:#fff; padding:9px 14px; font-size:11px; font-weight:400; letter-spacing:2px; text-align:left; }
  .p2-cat { background:#f4f4f4; font-size:11px; font-weight:700; letter-spacing:2px; color:#888; text-transform:uppercase; padding:8px 14px; font-family:'IBM Plex Mono',monospace; }
  .p2-num { padding:9px 12px; font-size:11px; color:#bbb; font-family:monospace; text-align:center; border-bottom:1px solid #f0f0f0; }
  .p2-item { padding:9px 14px; font-size:13px; border-bottom:1px solid #f0f0f0; }
  .cat-row td { border-bottom:none !important; }

  @page {
    size: A4;
    margin: 0;
  }
  @media print {
    .modal-actions,.header,.main,.bottom-bar { display:none !important; }
    .modal-overlay { position:fixed; inset:0; background:#fff; overflow:visible; }
    .modal { max-width:100%; }
    .page { max-width:100%; }
    .page1 {
      width: 210mm;
      min-height: 297mm;
      padding: 16mm 18mm;
      box-sizing: border-box;
      page-break-after: always;
    }
    .page2 { page-break-before:always; border-top:none; padding: 16mm 18mm; }
  }
  @media (min-width:768px) {
    body { font-size:17px; }
    .header { padding:20px 40px; }
    .header-logo { font-size:32px; }
    .header-sub { font-size:13px; }
    .main { max-width:780px; margin:0 auto; padding:40px 40px 220px; }
    .section-hd { font-size:13px; margin-bottom:20px; padding-bottom:14px; }
    .select-bar { margin-bottom:24px; }
    .btn-sm { font-size:13px; padding:12px 22px; border-radius:10px; }
    .category { margin-bottom:36px; }
    .category-name { font-size:13px; letter-spacing:2px; }
    .btn-cat { font-size:12px; padding:7px 14px; }
    .gear-item { padding:16px 18px; border-radius:12px; margin-bottom:7px; }
    .chk { width:32px; height:32px; font-size:20px; border-radius:8px; }
    .gear-name { font-size:16px; }
    .bottom-bar { max-width:780px; left:50%; transform:translateX(-50%); border-radius:16px 16px 0 0; border-left:1px solid var(--border); border-right:1px solid var(--border); }
    .bottom-bar.expanded { transform:translateX(-50%); }
    .bar-count { font-size:44px; }
    .bar-count-label { font-size:15px; }
    .bar-price { font-size:28px; }
    .bar-toggle { width:44px; height:44px; font-size:18px; }
    .sheet-inner { padding:0 28px 36px; gap:20px; }
    .block-label { font-size:12px; }
    .preset-btn { font-size:14px; padding:10px 18px; }
    .price-input { font-size:36px; }
    .price-currency { font-size:28px; }
    .field-label { font-size:12px; }
    .field-input { font-size:17px; padding:14px 16px; }
    .btn-generate { font-size:22px; padding:20px; }
    .doc { padding:56px; }
    .modal { max-width:800px; margin:auto; min-height:auto; }
  }
</style>
</head>
<body>
<div class="header">
  <div class="header-logo">IMOK</div>
  <div class="header-sub">Personal Gear Ê©üÊùêË¶ãÁ©ç„Çä</div>
</div>

<div class="main">
  <div class="section-hd">Ê©üÊùê„ÇíÈÅ∏Êäû</div>
  <div class="select-bar">
    <button class="btn-sm" onclick="selectAll()">ÂÖ®ÈÅ∏Êäû</button>
    <button class="btn-sm" onclick="clearAll()">ÂÖ®Ëß£Èô§</button>
  </div>
  <div id="gear-categories"></div>
</div>

<div class="bottom-bar" id="bottom-bar">
  <div class="bottom-bar-handle" onclick="toggleSheet()">
    <div class="bar-left">
      <span class="bar-count" id="bar-count">0</span>
      <span class="bar-count-label">ÁÇπÈÅ∏Êäû‰∏≠</span>
    </div>
    <div class="bar-right">
      <span class="bar-price" id="bar-price">¬•50,000</span>
      <div class="bar-toggle">‚ñ≤</div>
    </div>
  </div>
  <div class="sheet-body">
    <div class="sheet-inner">
      <div class="price-block">
        <div class="block-label">„Éë„ÉÉ„Ç±„Éº„Ç∏ÈáëÈ°ç</div>
        <div class="price-presets">
          <button class="preset-btn" onclick="setPrice(30000,this)">¬•30,000</button>
          <button class="preset-btn active" onclick="setPrice(50000,this)">¬•50,000</button>
          <button class="preset-btn" onclick="setPrice(80000,this)">¬•80,000</button>
          <button class="preset-btn" onclick="setPrice(100000,this)">¬•100,000</button>
        </div>
        <div class="price-input-wrap">
          <span class="price-currency">¬•</span>
          <input class="price-input" type="number" id="price-input" value="50000" step="5000" inputmode="numeric">
        </div>
      </div>
      <div class="client-block">
        <div class="field-group">
          <div class="field-label">ÂÆõÂÖàÔºà„ÇØ„É©„Ç§„Ç¢„É≥„ÉàÂêçÔºâ</div>
          <input class="field-input" id="client-name" placeholder="Ê†™Âºè‰ºöÁ§æ„Äá„Äá" type="text">
        </div>
        <div class="field-group">
          <div class="field-label">Ê°à‰ª∂Âêç</div>
          <input class="field-input" id="project-name" placeholder="„Éó„É≠„É¢„Éº„Ç∑„Éß„É≥ÊíÆÂΩ±" type="text">
        </div>
        <div class="field-group">
          <div class="field-label">ÊíÆÂΩ±Êó•</div>
          <input class="field-input" id="shoot-date" type="date">
        </div>
        <div class="field-group" style="margin-bottom:0">
          <div class="field-label">Ë¶ãÁ©çÁï™Âè∑Ôºà‰ªªÊÑèÔºâ</div>
          <input class="field-input" id="estimate-no" placeholder="EST-2024-001" type="text">
        </div>
      </div>
      <button class="btn-generate" id="gen-btn" onclick="generateEstimate()" disabled>Ë¶ãÁ©çÊõ∏„ÇíÁîüÊàê„Åô„Çã</button>
    </div>
  </div>
</div>

<div class="modal-overlay" id="modal">
  <div class="modal">
    <div class="doc" id="doc-content"></div>
    <div class="modal-actions">
      <button class="btn-print" onclick="window.print()">üñ® Âç∞Âà∑ / PDF‰øùÂ≠ò</button>
      <button class="btn-close2" onclick="closeModal()">Èñâ„Åò„Çã</button>
    </div>
  </div>
</div>

<script>
const GEAR_DATA = [
  { cat:"„Ç∑„Éç„É¨„É≥„Ç∫ / „Ç¢„Éä„É¢„É´„Éï„Ç£„ÉÉ„ÇØ", items:["SIRUI Venus 1.6X Anamorphic 35mm","SIRUI Venus 1.6X Anamorphic 50mm","SIRUI Venus 1.6X Anamorphic 75mm","SIRUI Venus 1.6X Anamorphic 100mm","SIRUI Venus 1.6X Anamorphic 135mm","Zunow WHV-075 0.75ÂÄç„ÉØ„Ç§„Ç≥„É≥"]},
  { cat:"„Éû„ÉÉ„Éà„Éú„ÉÉ„ÇØ„Çπ / „Éï„Ç£„É´„Çø„Éº (4√ó5.65)", items:["LMB-15 „Éû„ÉÉ„Éà„Éú„ÉÉ„ÇØ„Çπ (3stage)","ND0.3 (4√ó5.65)","BlackPromist (4√ó5.65)"]},
  { cat:"„Éï„Ç©„Éº„Ç´„Çπ / „É¢„Éã„Çø„Éº", items:["Tilta Nucleus M „ÉØ„Ç§„É§„É¨„Çπ„Éï„Ç©„Éº„Ç´„Çπ","TV-logic F-5A „É¢„Éã„Çø„Éº","SmallHD 502 „É¢„Éã„Çø„Éº","SmallHD indie 7 „É¢„Éã„Çø„Éº"]},
  { cat:"„ÉØ„Ç§„É§„É¨„Çπ‰ºùÈÄÅ", items:["Teradek BOLT 500 TX","Teradek BOLT 500 RX √ó2","Accsoon CINEVIEW TX","transmitterÁî®„Éó„É¨„Éº„Éà„Çª„ÉÉ„Éà","„Çπ„Éî„Ç¥„ÉÉ„Éà„Ç¢„ÉÄ„Éó„Çø„Éº„Çª„ÉÉ„Éà","iPad √ó2"]},
  { cat:"„Ç∏„É≥„Éê„É´ / „É™„Ç∞", items:["DJI RS4 „Ç∏„É≥„Éê„É´","RSÁî®„Éè„É≥„Éâ„É´","FX3 „Éà„ÉÉ„Éó„Éó„É¨„Éº„Éà","FX3 „Éè„Éº„Éï„Ç≤„Éº„Ç∏","LÂûã„Éó„É¨„Éº„Éà","„Éü„Éã„ÇØ„Ç§„ÉÉ„ÇØ„É™„É™„Éº„Çπ„Çª„ÉÉ„Éà"]},
  { cat:"„Ç¢„ÇØ„Çª„Çµ„É™„Éº / „Ç±„Éº„Éñ„É´", items:["NOGA „Ç¢„Éº„É†","BNCÁü≠„Ç±„Éº„Éñ„É´","HDMIÁü≠„Ç±„Éº„Éñ„É´","DtapÂª∂Èï∑/ÂàÜÈÖç","„É¨„Éô„É©„Éº„Çª„ÉÉ„Éà","ÂÖ≠Ëßí/„Éç„Ç∏Â§âÊèõ„Çª„ÉÉ„Éà","„Éû„É≥„Éï„É≠„ÉÉ„Éà„Éó„É¨„Éº„Éà„Çª„ÉÉ„Éà","SmallRig „Éü„Éã„Ç∑„Çß„Éº„Éâ","„Éä„Éé„ÇØ„É©„É≥„Éó„Çª„ÉÉ„Éà","SHAPE„Éë„É≥Ê£í","SmallRig 15mm„Éè„É≥„Éâ„É´"]},
  { cat:"‰∏∏ÂΩ¢„Éï„Ç£„É´„Çø„Éº", items:["82mm ND„Éï„Ç£„É´„Çø„Éº","82mm PL„Éï„Ç£„É´„Çø„Éº","82mm BD„Éï„Ç£„É´„Çø„Éº","82mm GG„Éï„Ç£„É´„Çø„Éº","77mm ND„Éï„Ç£„É´„Çø„Éº","77mm BS„Éï„Ç£„É´„Çø„Éº","77mm BD„Éï„Ç£„É´„Çø„Éº","77mm LC„Éï„Ç£„É´„Çø„Éº","77mm ENHAN„Éï„Ç£„É´„Çø„Éº","82mm„Éê„É™„Ç¢„Éñ„É´ND„Éï„Ç£„É´„Çø„Éº","77mm„Éê„É™„Ç¢„Éñ„É´ND„Éï„Ç£„É´„Çø„Éº","82mm„Éó„É≠„ÇØ„Çµ„Éº"]},
  { cat:"‰∏âËÑö / Èõ≤Âè∞", items:["SmallRig TRIBEX ‰∏âËÑö","SWFOTO LB-68 „É¨„Éô„É™„É≥„Ç∞„Éô„Éº„Çπ","TRIBEXÁî®„Çπ„Éó„É¨„ÉÉ„Çø„Éº"]},
  { cat:"„Ç´„É°„É©Êú¨‰Ωì / „É¨„É≥„Ç∫", items:["SONY FE 24-105mm F4","SONY Œ±7s III","Œ±7s IIIÁî®„Ç±„Éº„Ç∏","NP-FZ100 „Éê„ÉÉ„ÉÜ„É™„Éº √ó3"]},
  { cat:"ÈõªÊ∫ê / „Éê„ÉÉ„ÉÜ„É™„Éº", items:["„É¢„Éê„Ç§„É´„Éê„ÉÉ„ÉÜ„É™„Éº","NP-F550 √ó8","„ÉÅ„É£„Éº„Ç∏„É£„Éº„Çª„ÉÉ„Éà"]},
  { cat:"NIKON„É¨„É≥„Ç∫ (F„Éû„Ç¶„É≥„Éà)", items:["NIKON AI NIKKOR 20mm","NIKON AI NIKKOR 24mm","NIKON AI NIKKOR 35mm","NIKON AI NIKKOR 50mm","NIKON AI NIKKOR 85mm","NIKON AI NIKKOR 135mm","E-F„Éû„Ç¶„É≥„ÉàÂ§âÊèõ„Ç¢„ÉÄ„Éó„Çø„Éº"]},
  { cat:"DZOFilm Vespid (EF„Éû„Ç¶„É≥„Éà)", items:["DZOFilm Vespid PRIME 25mm","DZOFilm Vespid PRIME 35mm","DZOFilm Vespid PRIME 50mm","DZOFilm Vespid PRIME 75mm","DZOFilm Vespid PRIME 100mm","DZOFilm Vespid PRIME 125mm","E-EF„Éû„Ç¶„É≥„ÉàÂ§âÊèõ„Ç¢„ÉÄ„Éó„Çø„Éº","CANON EF 8-15mm T4 FishEye"]},
  { cat:"Èü≥Â£∞ / „Åù„ÅÆ‰ªñ", items:["„É≠„É≥„Ç∞„Ç¢„Éº„É†","RODE „Ç¨„É≥„Éû„Ç§„ÇØ","3.5mmÂª∂Èï∑„Ç±„Éº„Éñ„É´ / „Ç§„É§„Éõ„É≥","„Çπ„Éû„Éõ„Éõ„É´„ÉÄ„Éº","„Çπ„Çø„É≥„ÉâÁî®Èù¥‰∏ã","Ulanzi „Éï„Ç©„Ç∞„Éû„Ç∑„É≥","„Éó„É™„Ç∫„É†„Éï„Ç£„É´„Çø„Éº"]},
];

let selected = new Set();
function catSelect(btn, doSelect){
  const cat = btn.closest('.category');
  cat.querySelectorAll('.gear-item input').forEach(cb => {
    cb.checked = doSelect;
    const item = cb.dataset.item;
    const p = cb.closest('.gear-item');
    if(doSelect){ selected.add(item); p.classList.add('selected'); }
    else { selected.delete(item); p.classList.remove('selected'); }
  });
  updateUI();
}
function buildGearList() {
  const c = document.getElementById('gear-categories');
  GEAR_DATA.forEach((cat,ci) => {
    const d = document.createElement('div'); d.className='category';
    d.innerHTML = `<div class="category-header"><div class="category-name">${cat.cat}</div><div class="cat-btns"><button class="btn-cat" onclick="catSelect(this,true)">ÂÖ®ÈÅ∏Êäû</button><button class="btn-cat" onclick="catSelect(this,false)">Ëß£Èô§</button></div></div>`;
    cat.items.forEach((item,ii) => {
      const id=`g_${ci}_${ii}`;
      const row=document.createElement('label'); row.className='gear-item'; row.htmlFor=id;
      row.innerHTML=`<input type="checkbox" id="${id}" data-item="${item}"><div class="chk">‚úì</div><span class="gear-name">${item}</span>`;
      row.querySelector('input').addEventListener('change',function(){
        const p=this.closest('.gear-item');
        if(this.checked){selected.add(item);p.classList.add('selected');}
        else{selected.delete(item);p.classList.remove('selected');}
        updateUI();
      });
      d.appendChild(row);
    });
    c.appendChild(d);
  });
}
function updateUI(){
  const n=selected.size;
  document.getElementById('bar-count').textContent=n;
  document.getElementById('gen-btn').disabled=n===0;
  updateBarPrice();
}
function updateBarPrice(){
  const p=parseInt(document.getElementById('price-input').value)||0;
  document.getElementById('bar-price').textContent='¬•'+p.toLocaleString();
}
document.getElementById('price-input').addEventListener('input',updateBarPrice);
function setPrice(v,btn){
  document.getElementById('price-input').value=v;
  document.querySelectorAll('.preset-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active'); updateBarPrice();
}
function selectAll(){
  document.querySelectorAll('.gear-item input').forEach(cb=>{
    cb.checked=true; cb.closest('.gear-item').classList.add('selected'); selected.add(cb.dataset.item);
  }); updateUI();
}
function clearAll(){
  document.querySelectorAll('.gear-item input').forEach(cb=>{
    cb.checked=false; cb.closest('.gear-item').classList.remove('selected');
  }); selected.clear(); updateUI();
}
let sheetOpen=false;
function toggleSheet(){
  sheetOpen=!sheetOpen;
  document.getElementById('bottom-bar').classList.toggle('expanded',sheetOpen);
}
function fmtP(n){return '¬•'+Number(n).toLocaleString();}
function generateEstimate(){
  const price=parseInt(document.getElementById('price-input').value)||50000;
  const client=document.getElementById('client-name').value||'‚Äî';
  const project=document.getElementById('project-name').value||'‚Äî';
  const date=document.getElementById('shoot-date').value;
  const estNoInput=document.getElementById('estimate-no').value;
  let estNo;
  if(estNoInput){
    estNo=estNoInput;
  } else {
    const d=new Date();
    const ymd=`${d.getFullYear()}${String(d.getMonth()+1).padStart(2,'0')}${String(d.getDate()).padStart(2,'0')}`;
    if(!window._estCounter) window._estCounter={};
    if(!window._estCounter[ymd]) window._estCounter[ymd]=1;
    else window._estCounter[ymd]++;
    estNo=`${ymd}_${String(window._estCounter[ymd]).padStart(2,'0')}`;
  }
  const tax=Math.floor(price*0.1); const total=price+tax;

  // Format date as YYYY.MM.DD
  const now=new Date();
  const todayFmt=`${now.getFullYear()}.${String(now.getMonth()+1).padStart(2,'0')}.${String(now.getDate()).padStart(2,'0')}`;
  const shootDate=date?`${date.replace(/-/g,'.')}` :'‚Äî';

  // Page 2: gear rows grouped by category
  const gearRows = GEAR_DATA.map(cat => {
    const selItems = cat.items.filter(item => selected.has(item));
    if(selItems.length===0) return '';
    return `
      <tr class="cat-row"><td colspan="2" class="p2-cat">${cat.cat}</td></tr>
      ${selItems.map((item,i)=>`<tr><td class="p2-num">${String(i+1).padStart(2,'0')}</td><td class="p2-item">${item}</td></tr>`).join('')}
    `;
  }).join('');

  document.getElementById('doc-content').innerHTML=`

    <!-- ===== PAGE 1: Ë¶ãÁ©çÊõ∏ ===== -->
    <div class="page page1">

      <div class="p1-header">
        <div class="p1-left">
          <div class="p1-logo">IMOK</div>
          <div class="p1-logo-sub">‰ªäÂ≤° ÂÄã‰∫∫Ê©üÊùê„Éë„ÉÉ„Ç±„Éº„Ç∏</div>
        </div>
        <div class="p1-right">
          <div class="p1-title">ÊíÆÂΩ±Ê©üÊùêË≤ª Ë¶ãÁ©çÊõ∏</div>
          <div class="p1-meta">No. ${estNo}&nbsp;&nbsp;|&nbsp;&nbsp;${todayFmt}</div>
        </div>
      </div>

      <div class="p1-rule"></div>

      <div class="p1-info-grid">
        <div>
          <div class="p1-info-label">ÂÆõÂÖà</div>
          <div class="p1-info-value">${client}</div>
        </div>
        <div>
          <div class="p1-info-label">Ê°à‰ª∂Âêç</div>
          <div class="p1-info-value">${project}</div>
        </div>
        <div>
          <div class="p1-info-label">ÊíÆÂΩ±Êó•</div>
          <div class="p1-info-value">${shootDate}</div>
        </div>
        <div>
          <div class="p1-info-label">Ê©üÊùêÊâÄÊúâËÄÖ</div>
          <div class="p1-info-value bold">‰ªäÂ≤°Âà©Êòé</div>
          <div class="p1-info-sub">„Äí165-0026 Êù±‰∫¨ÈÉΩ‰∏≠ÈáéÂå∫Êñ∞‰∫ï1-36-9 Â≤°Áî∞„Éì„É´302</div>
          <div class="p1-info-sub">TEL: 090-5526-8190</div>
          <div class="p1-info-sub">mail@t-imok.com</div>
          <div class="p1-info-sub">ÁôªÈå≤Áï™Âè∑: T9810440218359</div>
        </div>

      </div>

      <table class="p1-table">
        <thead>
          <tr>
            <th class="p1-th-item">ÂìÅÁõÆ</th>
            <th class="p1-th-detail">Ë©≥Á¥∞</th>
            <th class="p1-th-price">ÈáëÈ°ç</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="p1-td-item">ÊíÆÂΩ±Ê©üÊùêË≤ª</td>
            <td class="p1-td-detail">ÁßÅÁâ©Ê©üÊùê‰∏ÄÂºèÔºà${selected.size}ÁÇπÔºâ<br><span style="font-size:11px;color:#888">‚ÄªË©≥Á¥∞„ÅØÂà•Á¥ô Ê©üÊùê‰∏ÄË¶ß„ÇíÂèÇÁÖß</span></td>
            <td class="p1-td-price">${fmtP(price)}</td>
          </tr>
        </tbody>
      </table>

      <div class="p1-total-wrap">
        <div class="p1-total-box">
          <div class="p1-total-row"><span>Â∞èË®à</span><span>${fmtP(price)}</span></div>
          <div class="p1-total-row"><span>Ê∂àË≤ªÁ®éÔºà10%Ôºâ</span><span>${fmtP(tax)}</span></div>
          <div class="p1-total-rule"></div>
          <div class="p1-total-row p1-total-main"><span>ÂêàË®à</span><span>${fmtP(total)}</span></div>
        </div>
      </div>

    </div>

    <!-- ===== PAGE 2: Ê©üÊùê‰∏ÄË¶ß ===== -->
    <div class="page page2">

      <div class="p1-header">
        <div class="p1-left">
          <div class="p1-logo">IMOK</div>
          <div class="p1-logo-sub">‰ªäÂ≤° ÂÄã‰∫∫Ê©üÊùê„Éë„ÉÉ„Ç±„Éº„Ç∏</div>
        </div>
        <div class="p1-right">
          <div class="p1-title" style="font-size:28px;">Ê©üÊùê‰∏ÄË¶ß</div>
          <div class="p1-meta">No. ${estNo}&nbsp;&nbsp;|&nbsp;&nbsp;${todayFmt}</div>
        </div>
      </div>

      <div class="p1-rule"></div>

      <div style="display:flex;gap:32px;margin-bottom:24px;font-size:13px;color:#666;">
        <span>ÊåÅÂèÇÊ©üÊùêÊï∞: <strong style="color:#111">${selected.size} ÁÇπ</strong></span>
        <span>Ê©üÊùêÊâÄÊúâËÄÖ: <strong style="color:#111">‰ªäÂ≤°Âà©Êòé</strong></span>
      </div>

      <table class="p2-table">
        <thead>
          <tr>
            <th class="p2-th-num">#</th>
            <th class="p2-th-item">Ê©üÊùêÂêçÁß∞</th>
          </tr>
        </thead>
        <tbody>
          ${gearRows}
        </tbody>
      </table>

      <div class="p1-rule" style="margin-top:24px;"></div>
      <div style="font-size:11px;color:#aaa;text-align:center;margin-top:12px;">
        IMOK Personal Gear Package ‚Äî ‰ªäÂ≤°ÂÄã‰∫∫Ê©üÊùêË¶ãÁ©çÊõ∏ÔºàÂà•Á¥ôÔºâ
      </div>

    </div>
  `;
  document.getElementById('modal').classList.add('open');
  sheetOpen=false; document.getElementById('bottom-bar').classList.remove('expanded');
}
function closeModal(){document.getElementById('modal').classList.remove('open');}
buildGearList();
document.getElementById('shoot-date').value=new Date().toISOString().split('T')[0];
</script>
</body>
</html>
